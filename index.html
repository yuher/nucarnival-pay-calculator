<!DOCTYPE html>
<html>
	<head>
		<title>新世界狂歡 $ 課金試算機 $</title>
		<meta name="viewport" content="width=device-width,initial-scale=1">
		<meta property="og:site_name" content="新世界狂歡 $ 課金試算機 $" />
		<meta property="og:image" content="https://i.imgur.com/h1HroAv.jpg" />
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
		<style>
			.clear {
				flex-basis: 42px !important;
				cursor: pointer;
			}
			.clear:hover {
				color: rgb(132, 32, 41);
			}
		</style>
	</head>
	<body>
		<div class="container">
			<h1 class="fw-bold my-4 text-center text-success"><div class="fs-2">新世界狂歡</div>$ 課金試算機 $</h1>
			<div class="row justify-content-center">
				<div class="col-12 col-md-6 col-lg-3">
					<div class="input-group mb-3">
						<span class="input-group-text" id="basic-addon1">已持有之 ECoin</span>
						<input type="number" class="form-control text-end holdPoint" placeholder="0" aria-label="Username" aria-describedby="basic-addon1" min="0" max="50000">
					</div>
					<h3>購買項目</h3>
					<div class="input-group mb-3">
						<button class="btn btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">選擇禮包</button>
						<ul class="dropdown-menu">
							<li><a class="dropdown-item" href="#" data-point="599">豪華月卡 (599)</a></li>
							<li><a class="dropdown-item" href="#" data-point="224">月卡 (224)</a></li>
							<li><a class="dropdown-item" href="#" data-point="374">旅行應援包 (374)</a></li>
							<li><a class="dropdown-item" href="#" data-point="4224">高級鑰匙組合 (4224)</a></li>
							<li><a class="dropdown-item" href="#" data-point="7499">章節突破SP (7499)</a></li>
							<li><a class="dropdown-item" href="#" data-point="674">LV.35禮包 (674)</a></li>
							<li><hr class="dropdown-divider"></li>
							<li><a class="dropdown-item" href="#">自填</a></li>
						</ul>
						<input type="number" class="form-control text-end requiredPoints" aria-label="Text input with dropdown button" min="0" max="10000">
						<span class="form-control text-end flex-grow-0 clear"><i class="bi bi-x-lg"></i></span>
					</div>
					<div class="input-group mb-3">
						<button class="btn btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">選擇禮包</button>
						<ul class="dropdown-menu">
							<li><a class="dropdown-item" href="#" data-point="599">豪華月卡 (599)</a></li>
							<li><a class="dropdown-item" href="#" data-point="224">月卡 (224)</a></li>
							<li><a class="dropdown-item" href="#" data-point="374">旅行應援包 (374)</a></li>
							<li><a class="dropdown-item" href="#" data-point="4224">高級鑰匙組合 (4224)</a></li>
							<li><a class="dropdown-item" href="#" data-point="7499">章節突破SP (7499)</a></li>
							<li><a class="dropdown-item" href="#" data-point="674">LV.35禮包 (674)</a></li>
							<li><hr class="dropdown-divider"></li>
							<li><a class="dropdown-item" href="#">自填</a></li>
						</ul>
						<input type="number" class="form-control text-end requiredPoints" aria-label="Text input with dropdown button" min="0" max="10000">
						<span class="form-control text-end flex-grow-0 clear"><i class="bi bi-x-lg"></i></span>
					</div>
					<div class="input-group mb-3">
						<button class="btn btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">選擇禮包</button>
						<ul class="dropdown-menu">
							<li><a class="dropdown-item" href="#" data-point="599">豪華月卡 (599)</a></li>
							<li><a class="dropdown-item" href="#" data-point="224">月卡 (224)</a></li>
							<li><a class="dropdown-item" href="#" data-point="374">旅行應援包 (374)</a></li>
							<li><a class="dropdown-item" href="#" data-point="4224">高級鑰匙組合 (4224)</a></li>
							<li><a class="dropdown-item" href="#" data-point="7499">章節突破SP (7499)</a></li>
							<li><a class="dropdown-item" href="#" data-point="674">LV.35禮包 (674)</a></li>
							<li><hr class="dropdown-divider"></li>
							<li><a class="dropdown-item" href="#">自填</a></li>
						</ul>
						<input type="number" class="form-control text-end requiredPoints" aria-label="Text input with dropdown button" min="0" max="10000">
						<span class="form-control text-end flex-grow-0 clear"><i class="bi bi-x-lg"></i></span>
					</div>
					<div class="input-group mb-3">
						<button class="btn btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">選擇禮包</button>
						<ul class="dropdown-menu">
							<li><a class="dropdown-item" href="#" data-point="599">豪華月卡 (599)</a></li>
							<li><a class="dropdown-item" href="#" data-point="224">月卡 (224)</a></li>
							<li><a class="dropdown-item" href="#" data-point="374">旅行應援包 (374)</a></li>
							<li><a class="dropdown-item" href="#" data-point="4224">高級鑰匙組合 (4224)</a></li>
							<li><a class="dropdown-item" href="#" data-point="7499">章節突破SP (7499)</a></li>
							<li><a class="dropdown-item" href="#" data-point="674">LV.35禮包 (674)</a></li>
							<li><hr class="dropdown-divider"></li>
							<li><a class="dropdown-item" href="#">自填</a></li>
						</ul>
						<input type="number" class="form-control text-end requiredPoints" aria-label="Text input with dropdown button" min="0" max="10000">
						<span class="form-control text-end flex-grow-0 clear"><i class="bi bi-x-lg"></i></span>
					</div>
					<div class="input-group mb-3">
						<button class="btn btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">選擇禮包</button>
						<ul class="dropdown-menu">
							<li><a class="dropdown-item" href="#" data-point="599">豪華月卡 (599)</a></li>
							<li><a class="dropdown-item" href="#" data-point="224">月卡 (224)</a></li>
							<li><a class="dropdown-item" href="#" data-point="374">旅行應援包 (374)</a></li>
							<li><a class="dropdown-item" href="#" data-point="4224">高級鑰匙組合 (4224)</a></li>
							<li><a class="dropdown-item" href="#" data-point="7499">章節突破SP (7499)</a></li>
							<li><a class="dropdown-item" href="#" data-point="674">LV.35禮包 (674)</a></li>
							<li><hr class="dropdown-divider"></li>
							<li><a class="dropdown-item" href="#">自填</a></li>
						</ul>
						<input type="number" class="form-control text-end requiredPoints" aria-label="Text input with dropdown button" min="0" max="10000">
						<span class="form-control text-end flex-grow-0 clear"><i class="bi bi-x-lg"></i></span>
					</div>
				</div>
				<div class="col-12 col-md-6 col-lg-3">
					<button type="submit" class="btn col-12 btn-success mb-3 calculate" >開始計算</button>
					<h3>計算結果</h3>
					<div class="card border-success mb-3 d-none result equal">
						<div class="card-header bg-transparent border-success text-success fw-bold">點數及金額最佳方案</div>
						<div class="card-body text-success">
							<ul class="list-group list-group-flush">
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>60</div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>120</div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>360 <span class="text-secondary">(350+10)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>720 <span class="text-secondary">(700+20)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>1200 <span class="text-secondary">(1160+40)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>2400 <span class="text-secondary">(2320+80)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>3675 <span class="text-secondary">(3550+125)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>7350 <span class="text-secondary">(7000+350)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>12400 <span class="text-secondary">(11800+600)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>24200 <span class="text-secondary">(23000+1200)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center text-secondary" style="font-size: 0.9rem;">
									※本程式每面額最大購買次數為 3
								</li>
							</ul>
						</div>
						<div class="card-footer bg-transparent border-success d-flex">
							<div class="me-3">
								<div>購買之 ECoin</div>
								<div>需求之 ECoin</div>
								<div>剩餘之 ECoin</div>
								<div>合計新台幣</div>
							</div>
							<div>
								<div class="text-end totalECoin"></div>
								<div class="text-end targetECoin"></div>
								<div class="text-end fw-bold text-success leftECoin" style="--bs-success-rgb: 132, 32, 41;"></div>
								<div class="text-end fw-bold text-success totalDollars" style="--bs-success-rgb: 132, 32, 41;"></div>
							</div>
						</div>
					</div>
					
					<div class="card border-success mb-3 d-none result dollarBest">
						<div class="card-header bg-transparent border-success text-success fw-bold">金額最佳方案</div>
						<div class="card-body text-success">
							<ul class="list-group list-group-flush">
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>60</div>
									<div class="badge bg-success rounded-pill" style="--bs-primary-rgb: 110, 168, 254;"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>120</div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>360 <span class="text-secondary">(350+10)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>720 <span class="text-secondary">(700+20)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>1200 <span class="text-secondary">(1160+40)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>2400 <span class="text-secondary">(2320+80)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>3675 <span class="text-secondary">(3550+125)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>7350 <span class="text-secondary">(7000+350)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>12400 <span class="text-secondary">(11800+600)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>24200 <span class="text-secondary">(23000+1200)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center text-secondary" style="font-size: 0.9rem;">
									※本程式每面額最大購買次數為 3
								</li>
							</ul>
						</div>
						<div class="card-footer bg-transparent border-success d-flex">
							<div class="me-3">
								<div>購買之 ECoin</div>
								<div>需求之 ECoin</div>
								<div>剩餘之 ECoin</div>
								<div>合計新台幣</div>
							</div>
							<div>
								<div class="text-end totalECoin"></div>
								<div class="text-end targetECoin"></div>
								<div class="text-end leftECoin"></div>
								<div class="text-end fw-bold text-success totalDollars" style="--bs-success-rgb: 132, 32, 41;"></div>
							</div>
						</div>
					</div>
					
					<div class="card border-success mb-3 d-none result pointBest">
						<div class="card-header bg-transparent border-success text-success fw-bold">點數最佳方案</div>
						<div class="card-body text-success">
							<ul class="list-group list-group-flush">
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>60</div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>120</div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>360 <span class="text-secondary">(350+10)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>720 <span class="text-secondary">(700+20)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>1200 <span class="text-secondary">(1160+40)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>2400 <span class="text-secondary">(2320+80)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>3675 <span class="text-secondary">(3550+125)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>7350 <span class="text-secondary">(7000+350)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>12400 <span class="text-secondary">(11800+600)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center">
									<div>24200 <span class="text-secondary">(23000+1200)</span></div>
									<div class="badge bg-success rounded-pill"><span class="times">1</span> 次</div>
								</li>
								<li class="list-group-item d-flex justify-content-between align-items-center text-secondary" style="font-size: 0.9rem;">
									※本程式每面額最大購買次數為 3
								</li>
							</ul>
						</div>
						<div class="card-footer bg-transparent border-success d-flex">
							<div class="me-3">
								<div>購買之 ECoin</div>
								<div>需求之 ECoin</div>
								<div>剩餘之 ECoin</div>
								<div>合計新台幣</div>
							</div>
							<div>
								<div class="text-end totalECoin"></div>
								<div class="text-end targetECoin"></div>
								<div class="text-end fw-bold text-success leftECoin" style="--bs-success-rgb: 132, 32, 41;"></div>
								<div class="text-end totalDollars"></div>
							</div>
						</div>
					</div>
					<div class="card border-success mb-3 d-none result notRequire text-center p-4">不需要課金 ʕ•̫͡•ʕ•̫͡•ʔ•̫͡•ʔ•̫͡•ʕ•̫͡•ʔ•̫͡•ʕ•̫͡•ʕ•̫͡•ʔ•̫͡•ʔ•̫͡•ʕ•̫͡•ʔ•̫͡•ʔ</div>
					<div class="card border-success mb-3 result text-center p-4">來算算多少錢錢才能色色吧</div>
					<!-- <div class="card border-success mb-3 loading text-center p-4 d-none">
						<div class="text-center">
							<div class="spinner-border text-center" style="width: 3rem; height: 3rem;" role="status">
								<span class="visually-hidden">Loading...</span>
							</div>
						</div>
					</div> -->
				</div>
			</div>
		</div>

		<script>
			//每個項目最多三次
			//輸入上限50k

			let TYPE = 10;
			let point	= [60, 120, 360, 720, 1200, 2400, 3675, 7350, 12400, 24200];
			let gift	= [0,    0,  10,  20,   40,   80,  125,  350,   600,  1200];
			let ntd		= [28,  56, 165, 330,  545, 1090, 1669, 3290,  5547, 10812];
			let max_c 	= [0,    0,   0,   0,    0,    0,    0,    0,     0,     0];
			let cur_c	= [0,    0,   0,   0,    0,    0,    0,    0,     0,     0];
			let less_gift, less_count, less_ntd, less_point;
			let less_gift_c, less_count_c, less_ntd_c, less_point_c;

			function numberWithCommas(x) {
				return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
			}
			function calculate(target) {
				if(target <= 60) {
					updateResult(document.querySelector('.result.equal'), [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], target, ntd[0], point[0]);
					return;
				}

				max_c.forEach((c, i, a) => {
					a[i] = Math.ceil(target/point[i]) > 3 ? 3 : Math.ceil(target/point[i]);
				});
				
				//console.log(max_c);

				let less_gift = target;
				let less_count = target; 
				let less_ntd = target;
				let less_point = target * 2;

				for(cur_c[0] = 0 ; cur_c[0] <= max_c[0] ; ++cur_c[0]) {
					for(cur_c[1] = 0 ; cur_c[1] <= max_c[1] ; ++cur_c[1]) {
						for(cur_c[2] = 0 ; cur_c[2] <= max_c[2] ; ++cur_c[2]) {
							for(cur_c[3] = 0 ; cur_c[3] <= max_c[3] ; ++cur_c[3]) {
								for(cur_c[4] = 0 ; cur_c[4] <= max_c[4] ; ++cur_c[4]) {
									for(cur_c[5] = 0 ; cur_c[5] <= max_c[5] ; ++cur_c[5]) {
										for(cur_c[6] = 0 ; cur_c[6] <= max_c[6] ; ++cur_c[6]) {
											for(cur_c[7] = 0 ; cur_c[7] <= max_c[7] ; ++cur_c[7]) {
												for(cur_c[8] = 0 ; cur_c[8] <= max_c[8] ; ++cur_c[8]) {
													for(cur_c[9] = 0 ; cur_c[9] <= max_c[9] ; ++cur_c[9]) {
														
														let point_sum = 0;
														// let gift_sum = 0;
														let ntd_sum = 0;
														// let count_sum = 0;
														cur_c.forEach((c, i, a) => {
															point_sum += c * point[i];
															// gift_sum  += c * gift[i];
															ntd_sum   += c * ntd[i];
															// count_sum += c;
														});
														
														if( point_sum >= target && point_sum <= target * 2) {

															let left_point = point_sum - target;
															// let left_gift = (left_point >= gift_sum ? gift_sum : left_point);
															
															// if( left_gift <= less_gift ) {
															// 	less_gift = left_gift;
															// 	less_gift_c = cur_c.concat();
															// }
															// if( count_sum < less_count ) {
															// 	less_count = count_sum;
															// 	less_count_c = cur_c.concat();
															// }
															if( ntd_sum < less_ntd ) {
																less_ntd = ntd_sum;
																less_ntd_c = cur_c.concat();
															}
															if( point_sum < less_point ) {
																less_point = point_sum;
																less_point_c = cur_c.concat();
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}

				// console.log("less_gift = " + less_gift);
				// console.log(less_gift_c);
				// console.log("less_count = " + less_count);
				// console.log(less_count_c);
				// console.log("less_ntd = " + less_ntd);
				// console.log(less_ntd_c);
				
				// console.log("less_point = " + less_point);
				// console.log(less_point_c);

				let point_sum = 0;
				let ntd_sum = 0;
				if( JSON.stringify(less_point_c) == JSON.stringify(less_ntd_c) ) {
						less_point_c.forEach((c, i, a) => {
						point_sum += c * point[i];
						ntd_sum   += c * ntd[i];
					});
					// console.log("Result: " + ntd_sum + "ntd , point: " + point_sum + ", left = " + (point_sum - target));
					updateResult(document.querySelector('.result.equal'), less_point_c, target, ntd_sum, point_sum);
				} else {
					less_point_c.forEach((c, i, a) => {
						point_sum += c * point[i];
						ntd_sum   += c * ntd[i];
					});
					// console.log("A: " + ntd_sum + "ntd , point: " + point_sum + ", left = " + (point_sum - target));
					updateResult(document.querySelector('.result.pointBest'), less_point_c, target, ntd_sum, point_sum);
					point_sum = 0;
					ntd_sum = 0;
					less_ntd_c.forEach((c, i, a) => {
						point_sum += c * point[i];
						ntd_sum   += c * ntd[i];
					});
					// console.log("B: " + ntd_sum + "ntd , point: " + point_sum + ", left = " + (point_sum - target));
					updateResult(document.querySelector('.result.dollarBest'), less_ntd_c, target, ntd_sum, point_sum);
				}
			}
			function updateResult(eleResult, itemArray, target, ntd_sum, point_sum) {
				const eleList = eleResult.querySelectorAll('.list-group .list-group-item');
				for(let index = 0; index < itemArray.length; ++index) {
					eleList[index].querySelector('.times').parentNode.parentNode.classList.remove('d-none');
					eleList[index].querySelector('.times').innerText = itemArray[index];
					if(itemArray[index] <= 0) {
						eleList[index].querySelector('.times').parentNode.parentNode.classList.add('d-none');
					}
				}
				eleResult.querySelector('.totalECoin').innerText = numberWithCommas(point_sum);
				eleResult.querySelector('.targetECoin').innerText = numberWithCommas(target);
				eleResult.querySelector('.leftECoin').innerText = numberWithCommas(point_sum - target);
				eleResult.querySelector('.totalDollars').innerText = numberWithCommas(ntd_sum);
				eleResult.classList.remove('d-none');
			}

			document.querySelectorAll('.dropdown-menu .dropdown-item').forEach(function(ele) {
				ele.addEventListener('click', function(event) {
					if(event.target.dataset['point']) {
						event.target.parentNode.parentNode.parentNode.querySelector('.form-control').value = event.target.dataset['point'];
					}
					else {
						event.target.parentNode.parentNode.parentNode.querySelector('.form-control').value = '';
						event.target.parentNode.parentNode.parentNode.querySelector('.form-control').focus();
					}
				});
			});

			document.querySelectorAll('.clear').forEach(function(ele) {
				ele.addEventListener('click', function(event) {
					event.currentTarget.parentNode.querySelector('.form-control').value = '';
				});
			});

			document.querySelector('.calculate').addEventListener('click', function() {
				let pointRequired = 0;
				document.querySelectorAll('.requiredPoints').forEach(function(ele) {
					if(ele.value) {
						if(Number(ele.value) < Number(ele.getAttribute('min')) || Number(ele.value) > Number(ele.getAttribute('max'))) {
							alert(`購買項目需介於 ${ele.getAttribute('min')} ~ ${ele.getAttribute('max')}`);
							return;
						}
						pointRequired += Number(ele.value);
					}
				});
				let eleHoldPoint = document.querySelector('.holdPoint');
				if(Number(eleHoldPoint.value) < Number(eleHoldPoint.getAttribute('min')) || Number(eleHoldPoint.value) > Number(eleHoldPoint.getAttribute('max'))) {
					alert(`已持有之 ECoin 需介於 ${eleHoldPoint.getAttribute('min')} ~ ${eleHoldPoint.getAttribute('max')}`);
					return;
				}
				pointRequired -= Number(eleHoldPoint.value);
				document.querySelectorAll('.result').forEach(function(ele) {
					ele.classList.add('d-none');
				});
				if(pointRequired > 0) {
					// let eleLoading = document.querySelector('.loading');
					// eleLoading.classList.remove('d-none');
					calculate(pointRequired);
					// eleLoading.classList.add('d-none');
				}
				else {
					document.querySelector('.result.notRequire').classList.remove('d-none');
				}
			});
		</script>
	</body>
</html>
